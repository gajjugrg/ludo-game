*{box-sizing:border-box;font-family:system-ui,-apple-system,Segoe UI,Roboto,'Helvetica Neue',Arial}
body{display:flex;flex-direction:column;align-items:center;margin:0;padding:16px;background:#f6f7fb;color:#222}
header{width:100%;max-width:1100px;display:flex;justify-content:space-between;align-items:center;gap:14px;padding:12px 14px;border-radius:14px;background:#fff;box-shadow:0 8px 20px rgba(0,0,0,0.07)}
header h1{margin:0}
.controls{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
.controls label{display:flex;gap:6px;align-items:center;font-size:12px;color:#4b5563}
.controls input[type=text], .controls select{padding:7px 8px;border-radius:10px;border:1px solid #d0d7e2;background:#fff;color:#222;outline:none}
.controls input[type=text]:focus, .controls select:focus{box-shadow:0 0 0 3px rgba(28,74,193,0.10);border-color:#c7d2fe}
.controls button{padding:8px 12px;border-radius:10px}
#connStatus{padding:4px 8px;border-radius:999px;background:#f3f6ff;border:1px solid #dbe3f2;display:inline-block;min-height:20px}
.controls .dice{display:flex;gap:8px;align-items:center}
#board{width:640px;height:640px;background:linear-gradient(180deg,#f8f9fb,#eef2f9);border-radius:12px;box-shadow:0 6px 18px rgba(0,0,0,0.08);position:relative;overflow:visible;padding:10px}
#board .cell{display:flex;align-items:center;justify-content:center;font-size:11px;border:1px solid rgba(0,0,0,0.05)}
#board .cell.path{background:#f9fbff;border:1px solid #dfe5f2;box-sizing:border-box;position:relative}
.board .cell.home{border:0}
.board .cell.safe{box-shadow:inset 0 0 0 4px rgba(255,215,0,0.12);border:1px solid rgba(255,215,0,0.2);background:linear-gradient(135deg,rgba(255,215,0,0.12),rgba(255,215,0,0))}
.board .cell.start.red{outline:2px solid rgba(255,128,128,0.8);background:#ff9a9a;color:#fff}
.board .cell.start.green{outline:2px solid rgba(90,210,150,0.8);background:#73e0a4;color:#fff}
.board .cell.start.yellow{outline:2px solid rgba(255,210,96,0.8);background:#ffe07a;color:#222}
.board .cell.start.blue{outline:2px solid rgba(116,178,255,0.8);background:#9ac8ff;color:#fff}
#board .cell.path.start.red{background:#ff9a9a;color:#fff}
#board .cell.path.start.green{background:#73e0a4;color:#fff}
#board .cell.path.start.yellow{background:#ffe07a;color:#222}
#board .cell.path.start.blue{background:#9ac8ff;color:#fff}
.token{width:34px;height:34px;border-radius:50%;display:flex;align-items:center;justify-content:center;color:#fff;font-size:13px;position:absolute;transform:translate(-50%,-50%);box-shadow:0 3px 6px rgba(0,0,0,0.18);z-index:10}
.token.red{background:#ff4d4d}
.token.green{background:#29cc71}
.token.yellow{background:#ffcf33;color:#222}
.token.blue{background:#4fa8ff}
.home-badge{position:absolute;bottom:8px;left:8px;background:rgba(0,0,0,0.06);padding:4px 6px;border-radius:6px;font-size:12px}
.side-panel{margin-top:0}
#playersList{list-style:none;padding:0;margin:0}
#status{min-width:260px}
.play-area{display:flex;gap:16px;align-items:flex-start;flex-wrap:wrap}
.right-panel{display:flex;flex-direction:column;gap:12px;align-items:center}
.dice-panel{display:flex;flex-direction:column;gap:10px;align-items:center;padding:10px 14px;border-radius:12px;background:#fff;box-shadow:0 8px 20px rgba(0,0,0,0.07);width:100%;margin-top:70px}
.dice-lg{display:flex;align-items:center;gap:12px}
.dice-btn{width:46px;height:46px;border-radius:10px;border:1px solid #e6edf9;background:linear-gradient(180deg,#fff,#eaf2ff);display:flex;align-items:center;justify-content:center;box-shadow:0 6px 14px rgba(28,74,193,0.06);transition:transform 0.4s ease}
.dice-btn-lg{width:78px;height:78px;border-radius:16px;border:1px solid #d0d8ee;box-shadow:0 10px 24px rgba(28,74,193,0.08);animation:diceIdle 1.8s ease-in-out infinite}
.dice-btn.rolling{transform:rotate(20deg);transition:transform 0.6s cubic-bezier(.25,.8,.25,1)}
.dice-label{font-size:12px;color:#5b6475}
.dice-value{font-size:28px;font-weight:700}
.dice-icon{width:40px;height:40px}
#board .cell{display:flex;align-items:center;justify-content:center;font-size:11px}
.hidden{display:none}
.debug-unlock{margin-top:16px;display:flex;gap:8px;align-items:center;flex-wrap:wrap}
.debug-unlock input{padding:6px 8px;border-radius:6px;border:1px solid #d0d7e2}
.debug-panel{margin-top:16px;padding:12px;border:1px dashed #d0d7e2;border-radius:10px;background:#f7f9ff;max-width:600px}
.debug-panel h3{margin:0 0 8px;font-size:16px}
.debug-row{display:flex;gap:8px;align-items:center;flex-wrap:wrap;margin-bottom:6px}
.debug-panel input[type=number]{width:64px}
.debug-panel select{min-width:80px}
.debug-actions button{flex:1;min-width:140px}
.debug-note{margin:4px 0 0;font-size:12px;color:#4f5d75}
button{cursor:pointer;padding:8px 12px;border-radius:8px;border:1px solid #e0e6f0;background:#fff}
button:active{transform:translateY(1px)}
#rollBtn{background:linear-gradient(#fff,#f0f6ff);border:1px solid #cfd9ff}
#diceValue{min-width:24px;text-align:center}
.dice-btn.rolling{transform:rotate(20deg);transition:transform 0.6s cubic-bezier(.25,.8,.25,1)}
.cell.block{box-shadow:inset 0 0 0 4px rgba(0,0,0,0.08);border:2px solid rgba(0,0,0,0.12)}
@media(max-width:820px){#board{width:90vw;height:90vw}}
@media(max-width:820px){.dice-panel{margin-top:0}}

#board .container{width:100%;height:100%;margin:auto;margin-top:8px;cursor:default;position:relative;display:grid;grid-template-columns:repeat(15,1fr);grid-template-rows:repeat(15,1fr);background:#fefefe;border-radius:10px;overflow:hidden}
#board .cell{border:1px solid rgba(0,0,0,0.05)}
#board .cell.home{border:0 !important;outline:0!important;box-shadow:none;background-clip:border-box;background-origin:border-box;border-color:transparent}
#board .cell.home.green{background:#c8eaa2}
#board .cell.home.yellow{background:#ffe993}
#board .cell.home.red{background:#ffbbbb}
#board .cell.home.blue{background:#aed7ff}
#board .cell.finish.green{background:rgba(132,194,31,0.26);border:1px solid rgba(132,194,31,0.4)}
#board .cell.finish.yellow{background:rgba(246,199,0,0.26);border:1px solid rgba(246,199,0,0.4)}
#board .cell.finish.red{background:rgba(220,36,24,0.26);border:1px solid rgba(220,36,24,0.4)}
#board .cell.finish.blue{background:rgba(0,146,220,0.26);border:1px solid rgba(0,146,220,0.4)}
#board .cell.center-cell{background:transparent;font-weight:700;color:#1f3f7f;letter-spacing:0.5px;border:0 !important;position:relative}
#board .container{position:relative}
#board .container::before{
  content:'';
  position:absolute;
  left:40%;
  top:40%;
  width:20%;
  height:20%;
  background:conic-gradient(from -45deg, #ffe9a3 0deg 90deg,#b7d7ff 90deg 180deg,#ffc9c9 180deg 270deg,#c7f1d9 270deg 360deg);
  pointer-events:none;
  z-index:1;
}
#board .container::after{
  content:'';
  position:absolute;
  left:40%;
  top:40%;
  width:20%;
  height:20%;
  background:
    linear-gradient(45deg,transparent 49%,#fff 49%,#fff 51%,transparent 51%),
    linear-gradient(-45deg,transparent 49%,#fff 49%,#fff 51%,transparent 51%);
  pointer-events:none;
  z-index:2;
}
#board .cell.path{background:#f9fbff;position:relative}
#board .star-icon{width:18px;height:18px;position:absolute;left:6px;top:6px;fill:#ffda44;pointer-events:none}
#board .shield-icon{width:20px;height:20px;position:absolute;inset:0;margin:auto;opacity:0.9;filter:drop-shadow(0 2px 4px rgba(0,0,0,0.18));pointer-events:none}
#board .cell.path::after{content:'';position:absolute;top:50%;left:50%;width:12px;height:12px;border:3px solid #6b7bff;border-left:0;border-top:0;transform:translate(-50%,-50%) rotate(-45deg);opacity:0.9;border-radius:2px;pointer-events:none}
#board .cell.path.dir-n::after{transform:translate(-50%,-50%) rotate(-135deg)}
#board .cell.path.dir-s::after{transform:translate(-50%,-50%) rotate(45deg)}
#board .cell.path.dir-w::after{transform:translate(-50%,-50%) rotate(135deg)}
#board .cell.safe::after{display:none}
.token.selectable{outline:3px solid rgba(66,150,255,0.9);transform:translate(-50%,-50%) scale(1.08)}
.cell.block{box-shadow:inset 0 0 0 6px rgba(0,0,0,0.08);border:2px solid rgba(0,0,0,0.12)}
.dice-pips{width:24px;height:24px;display:grid;grid-template-columns:repeat(3,1fr);grid-template-rows:repeat(3,1fr);gap:2px;place-items:center}
.dice-pip{width:6px;height:6px;border-radius:50%;background:#333;opacity:0}
.dice-pip.on{opacity:1}
@media only screen and (max-width:600px){#board .container{margin-top:12px}}

.token.selectable{animation:blink 0.9s infinite alternate;outline:3px solid rgba(66,150,255,0.9);transform:translate(-50%,-50%) scale(1.08)}
@keyframes blink{from{filter:drop-shadow(0 0 4px rgba(66,150,255,0.8));}to{filter:drop-shadow(0 0 10px rgba(66,150,255,1));}}
.token.finished-token{box-shadow:0 6px 14px rgba(0,0,0,0.2)}
.token.finish-landing{animation:finishDrop 0.65s ease}
@keyframes finishDrop{
  0%{transform:translate(-50%,-70%) scale(0.35);opacity:0;}
  60%{transform:translate(-50%,-52%) scale(1.08);opacity:1;}
  100%{transform:translate(-50%,-50%) scale(1);}
}
@keyframes diceIdle{
  0%,100%{transform:translateY(0);}
  50%{transform:translateY(-5px);}
}

#centerNotice{position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);background:rgba(0,20,60,0.8);color:#fff;padding:14px 18px;border-radius:10px;font-weight:700;opacity:0;pointer-events:none;transition:opacity 0.35s ease, transform 0.35s ease;z-index:9999}
#centerNotice.show{opacity:1;transform:translate(-50%,-50%) scale(1.02)}
.cell.turn-home{animation:turnPulse 1s infinite;outline:3px solid rgba(255,255,255,0.9)!important;box-shadow:0 0 12px rgba(0,0,0,0.35)}
@keyframes turnPulse{0%{filter:brightness(1);}50%{filter:brightness(1.25);}100%{filter:brightness(1);}}
#status{display:block;min-height:18px;max-width:320px;width:100%;text-align:center;font-size:13px;line-height:1.25;color:#4b5563}

.finish-basket{margin-top:12px;padding:10px 14px;border-radius:12px;background:#f8fbff;border:1px solid #dbe3f2;box-shadow:0 6px 16px rgba(0,0,0,0.06);max-width:740px;width:100%}
.basket-title{margin:0 0 8px;font-weight:700;color:#2f3f57}
.basket-row{display:flex;gap:10px;flex-wrap:wrap}
.basket-slot{flex:1;min-width:120px;height:64px;border-radius:10px;position:relative;overflow:hidden;box-shadow:inset 0 0 0 1px rgba(0,0,0,0.06);background:#fff}
.basket-slot.red{background:linear-gradient(135deg,rgba(255,77,77,0.12),#fff)}
.basket-slot.green{background:linear-gradient(135deg,rgba(41,204,113,0.12),#fff)}
.basket-slot.yellow{background:linear-gradient(135deg,rgba(255,207,51,0.18),#fff)}
.basket-slot.blue{background:linear-gradient(135deg,rgba(79,168,255,0.15),#fff)}
